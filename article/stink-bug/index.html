<!DOCTYPE html><html lang="en-US"><head><title>Stanley the stink bug</title><meta charset="UTF-8"><meta name="robots" content="index, follow"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="author" content="Steven Baldasty"><meta property="og:image" content><link rel="icon" type="image/x-icon" href="/logo.png"><link rel="stylesheet" href="/site.css"></head><body><div class="brand"><img src="/logo.png" title="Website logo" alt="Three stacked blue boxes with binary digits on them" width="86" height="86"><div class="exposition"><div class="title">Bit flipping laboratory &amp; Personal website</div><div class="caption">No sneaky cookies haunt these pages, but whether someone tracks you I do not know. Information flows through many channels, and every action leaves a trace.</div></div></div><div class="nav"><div><a href="/">Home</a></div><div><a href="/article/">Articles</a></div><div><a href="/argmap/">Argmap</a></div><div><a href="/media/">Media</a></div></div><hr><div class="article"><div class="date">2025-12-18</div><div class="summary">Tribute to Stanley the brown marmorated stink bug who came to winter in my apartment. Photo gallery. Setting up a DinoLite Basic USB microscope as a makeshift motion triggered trail camera to photograph him at his feeding station.</div><h1>Stanley the stink bug</h1><p>It's always lovely to meet a new bug friend in the fall. This is Stanley. An internet search leads me to believe he is a <a href="https://en.wikipedia.org/wiki/Brown_marmorated_stink_bug" target="blank_">brown marmorated stink bug</a>. Even though Stanley is technically an <i>invasive species</i> in Vermont, that's not his fault - and I welcome him to winter in my apartment. He seems like a nice bug, and takes up very little space. Wikipedia says <i>marmorated</i> means that his color pattern is like marble.</p><div class="sparse-gallery"><div class="glimpse"><img alt="Stink bug half visible between the slats of a window blind" height="105" src="stanley-on-window-blind.jpg" title="Stanley on a window blind" width="140"><div class="exposition"><div class="title">Stanley on a window blind</div><div>Stanley mostly stays out of sight, and most of the time I don't know where he is. I feel happy when I see him hanging out in non-obvious places, like hiding here between the slats of my window blinds.</div></div></div><div class="glimpse"><img alt="Stink bug standing on a webcam" height="105" src="stanley-on-webcam.jpg" title="Stanley exploring my webcam" width="140"><div class="exposition"><div class="title">Stanley exploring my webcam</div><div>Stanley loves exploring walls, but he explores my desk too. He likes to crawl along the top of my monitor. If he falls on his back, he can right himself easily using his long back legs.</div></div></div></div><p>I see him other places too, like in my closet or even in the hinge of my door. Now I have to check for him before I shut it so he doesn't get squashed!</p><h2>Taking care of Stanley</h2><p>One day I decided to get to know my new bug friend better. I learned he only lives for between 6 and 12 months. He's trying to survive the winter somewhere warm, but not too warm. He appreciates food, but moisture is even more important to him. I wanted to do my part to help him through the winter in comfort.</p><div class="sparse-gallery"><div class="glimpse"><img alt="Two bottle caps with food and water" height="105" src="feeding-station.jpg" title="Feeding station" width="140"><div class="exposition"><div class="title">Feeding station</div><div>ChatGPT recommended a water-soaked cotton ball and a piece of either apple or carrot. It also recommended placing the food and water against a wall, because stink bugs follow edges! I added the cardboard and bottle caps to keep things contained.</div></div></div></div><p>The feeding station could have been the end of that project, but then I had another idea...</p><h2>Makeshift trail camera</h2><p>A stupendous stink bug like Stanley deserves to have even the most routine aspects of his life carefully documented for posterity. Also, it <em>might</em> have helped a little that I already happened to have all the equipment I needed for this on-hand. I set up a makeshift trail camera using a <a href="https://www.dinolite.us/" target="blank_">DinoLite Basic USB microscope</a> and a headless Linux box running <a class="tech" href="https://motion-project.github.io/motion_guide.html" target="blank_" title="Motion detection software">motion</a> to capture photos whenever Stanley is active around his feeding station.</p><p>I chose under my bed as the location for the feeding station because the microscope has to be near the Linux box, and the Linux box has to be near the router. Moving the mattress to change Stanley's food and water is a little annoying though.</p><div class="sparse-gallery"><div class="glimpse"><img alt="Microscope under the bed pointing at a feeding station" height="105" src="under-my-bed.jpg" title="DinoLite Basic under bed" width="140"><div class="exposition"><div class="title">DinoLite Basic under bed</div><div>The microscope shines a bright LED constantly, so the constant darkness under the bed is not an issue. It points directly at Stanley's feeding station against the wall, and its magnification is tuned so that just the station is in frame.</div></div></div><div class="glimpse"><img alt="Small computer under a wireless router with cabling attached" height="105" src="headless-linux-box.jpg" title="Router and headless Linux box" width="140"><div class="exposition"><div class="title">Router and headless Linux box</div><div>I already used this little server for file backup. It always stays on and uses very little power, so it was the perfect option for the webcam. A fancier wifi-capable computer would give more flexibility in terms of where to place Stanley's feeding station.</div></div></div></div><p>The server runs <a href="https://www.alpinelinux.org/" target="blank_">Alpine Linux</a>. Here is how to install <a class="tech" href="https://motion-project.github.io/motion_guide.html" target="blank_" title="Motion detection software">motion</a> and its dependencies for what I think are image / video processing and webcam management, respectively.</p><pre class="snippet">sudo apk update
sudo apk add motion ffmpeg v4l-utils</pre><p>If the <a class="tech" href="https://motion-project.github.io/motion_guide.html" target="blank_" title="Motion detection software">motion</a> package cannot be found, you may need to edit <code>/etc/apk/repositories</code> and make sure the <i>test</i> repository or possibly the <i>community</i> repository is included. It's a cool package, so hopefully it will find its way into <i>main</i> eventually.</p><pre class="snippet">https://dl-cdn.alpinelinux.org/alpine/v3.23/main
https://dl-cdn.alpinelinux.org/alpine/v3.23/community
https://dl-cdn.alpinelinux.org/alpine/edge/testing</pre><p>The version numbers in these links will likely look slightly different from mine depending on your version of Alpine Linux.</p><h2>Motion configuration</h2><p>Here is my <a class="tech" href="https://motion-project.github.io/motion_guide.html" target="blank_" title="Motion detection software">motion</a> configuration file, located at <code>/etc/motion/motion.conf</code> along with my interpretation of the parameters. I worked with ChatGPT to set some of these, and I'm trusting it especially for <code>noise_tune</code>. I guess I'll really only know that it's working well once I start getting photos of Stanley. That said, it's encouraging there haven't been many false positives and that my finger is enough to trigger photos to be taken.</p><pre class="snippet"># I think this is about locking?
pid_file /var/run/motion/motion.pid

# This is the Dino Lite Basic device
video_device /dev/video0

# Capture images
picture_output on

# No movies
movie_output off

# Video framerate (not saved image rate), Dino Lite likes 5 it seems?
framerate 5

# How many frames in a row must contain motion to count
minimum_motion_frames 3

# Seconds to wait after motion to stop capturing
event_gap 3

# Where to save images
target_dir /var/lib/motion

# Timestamped filenames
picture_filename stanley-%Y%m%d-%H%M%S-%q

# Pixels that need to change to count as motion
threshold 4000

# Is it some &#34;color distance&#34; within which pixels are treated the same?
noise_level 48

# Might miss Stanley so do not use
noise_tune off

# Keep only latest 1000 pictures
on_picture_save /usr/local/bin/prune-motion-images.sh</pre><p>The <code>on_picture_save</code> line calls for more explanation. The idea here is to keep only the latest 1000 photos so that the storage on the server does not fill up, in case I don't check for a long time. Every time a photo is saved, the custom script at <code>/usr/local/bin/prune-motion-images.sh</code> gets called. It looks like this.</p><pre class="snippet">#!/bin/bash
find /var/lib/motion -type f -name &#39;*.jpg&#39; \
  -printf &#39;%T@ %p\n&#39; | sort -n | head -n -1000 | cut -d&#39; &#39; -f2- | xargs rm -f</pre><p>I think <a class="tech" href="https://motion-project.github.io/motion_guide.html" target="blank_" title="Motion detection software">motion</a> tries executing the script directly, so it needs to be executable, probably by anyone. From what I can tell, <a class="tech" href="https://motion-project.github.io/motion_guide.html" target="blank_" title="Motion detection software">motion</a> runs at its own user which may and may not share groups in common with my user.</p><pre class="snippet">sudo chmod 755 /usr/local/bin/prune_motion_images.sh</pre><h2>Camera management scripts</h2><p>The next steps involve communicating with the server over <a class="tech" href="https://www.uvm.edu/vacc/docs/start_guide/ssh" target="blank_" title="Opens secure shells on remote systems">ssh</a>. There are different ways to do this (and arguably key-based authentication is better) but I'll use <a class="tech" href="https://www.cyberciti.biz/faq/noninteractive-shell-script-ssh-password-provider" target="blank_" title="Password forwarder for ssh and scp">sshpass</a>. I'll assume there are some environment variables already set up.</p><ul><li><code>HOST</code>: Server IP address or hostname</li><li><code>USR</code>: My username for the server</li><li><code>PW</code>: Path to a file containing the password</li></ul><p>Technically, you could start and stop the <a class="tech" href="https://motion-project.github.io/motion_guide.html" target="blank_" title="Motion detection software">motion</a> service directly on the server, but it's more convenient to have client-side scripts. I put these lines in <code>stanley-start.sh</code> and <code>stanley-stop.sh</code> respectively. An easy way to tell they're working is that these commands will make the little LEDs on the microscope turn on and off.</p><pre class="snippet">sshpass -f $PW ssh $USR@$HOST &#34;sudo rc-service motion start&#34;
sshpass -f $PW ssh $USR@$HOST &#34;sudo rc-service motion stop&#34;</pre><p>Finally, a third script <code>stanley-retrieve.sh</code> moves the photos from the server. The first line copies the photos to a temporary directory on the client, and the second line deletes them from the server so you don't get duplicates the next time you run it.</p><pre class="snippet">sshpass -f $PW scp -rC $USR@$HOST:/var/lib/motion $HOME/tmp
sshpass -f $PW ssh $USR@$HOST &#34;sudo rm /var/lib/motion/*&#34;</pre> It's convenient but perhaps less secure to configure the user on the server permission to run <a class="tech" href="https://www.sudo.ws/" target="blank_" title="Runs commands as the root user">sudo</a> without entering a password.</div><hr class="top-gapped"><div class="author"><div class="exposition"><div class="title">Steven Baldasty</div><div class="caption">Proud father, Barefoot runner, Chocolate enthusiast, Seasoned software engineer, Starry eyed PhD student, Novice human</div></div><img src="/selfie.png" title="Sketch courtesy of my daughter" alt="Handsome brown haired man with glasses" width="80" height="88"></div></body></html>